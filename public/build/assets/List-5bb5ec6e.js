import{_ as M,b as F,c as oe,d as se}from"./CardBoxModal-b424615d.js";import{A as ne,_ as re,a as ce}from"./SectionMain-62dd47b2.js";import{r as s,u as J,x as ie,B as ue,N as de,w as me,a5 as ve,a6 as T,a7 as pe,l as H,o as r,c as i,E as n,z as p,b as a,a1 as R,a0 as fe,a as o,t as d,q as h,F as B,d as D,s as j,G as L,e as _e,J as be,m as he,$ as ge}from"./app-a4a1e86e.js";import{m as we,a as ke,b as ye,d as Ce,f as xe}from"./mdi-4b5bd968.js";import{_ as Ne}from"./BaseIcon-127a6522.js";import{u as G}from"./pieces-a65603a2.js";const Ee={key:0},Pe={class:"text-red-500 text-sm"},$e={key:1},Be={class:"text-green-400 text-sm"},Ve={class:"border border-gray-400 rounded-lg mx-10"},Ae=["value"],Me={key:0},Te={class:"text-red-500 text-sm"},De={key:1},Fe={class:"text-green-400 text-sm"},Ie=o("p",null,"Are you sure?",-1),Se={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800"},Ue=["onClick"],qe={key:0},ze={colspan:"6"},He={class:"w-full flex justify-center"},Re={class:"before:hidden whitespace-nowrap"},je={"data-label":"Created",class:"whitespace-nowrap"},Le={class:"text-gray-500 dark:text-slate-400"},Ge={"data-label":"Title"},Je={"data-label":"PieceId"},Oe={__name:"TableDataClient",props:{checkable:Boolean,setModalActive:{type:Boolean,default:!1}},emits:{},setup(N,{expose:k,emit:y}){const f=s(!1);k({showNewModal:()=>{f.value=!0}});const{t:c}=J(),P=s(!1),_=G(),{pieces:I,selectedPiece:$,loading:O}=ie(G()),V=s(!1),A=s(5),C=s(1),x=s([]);s(!1);const g=s(!1),b=s("");s([]);const m=s(null),v=s(null),u=s("");ue(()=>{_.fetch(),console.log("pieces",I)}),de(()=>{_.clear()});const S=s([{label:c("pieces.table.actions"),id:"actions"},{label:c("pieces.table.date"),id:"createdAt"},{label:c("pieces.table.piece"),id:"title"},{label:c("pieces.table.pieceNumber"),id:"id"}]);me(()=>{S.value.forEach(e=>{switch(e.id){case"actions":e.label=c("pieces.table.actions");break;case"createdAt":e.label=c("pieces.table.date");break;case"title":e.label=c("pieces.table.piece");break;case"id":e.label=c("pieces.table.pieceNumber");break}})});const U=ve().shape({piece:T().min(1).required(),password:T().min(8).required(),password_confirmation:T().required().oneOf([pe("password")],"Passwords do not match")}),q=H(()=>{const e=I.value.map(l=>({createdAt:l.created_at,title:l.piece_title,services:l.services,id:l.id}));return e.sort((l,t)=>l[b.value]>t[b.value]?g.value?1:-1:l[b.value]<t[b.value]?g.value?-1:1:0),e}),K=H(()=>q.value.slice(A.value*(C.value-1),A.value*C.value)),Q=(e,l)=>{const t=[];return e.forEach(w=>{l(w)||t.push(w)}),t},W=(e,l)=>{e?x.value.push(l):x.value=Q(x.value,t=>t.id===l.id)},X=e=>{b.value===e?g.value=!g.value:(g.value=!0,e!="actions"&&(b.value=e))},Y=e=>{console.log(e),C.value=e.pageNumber,A.value=e.pageSize},Z=e=>{_.setSelectedPiece(e),u.value=e.title,P.value=!0},ee=e=>{_.setSelectedPiece(e),V.value=!0},z=e=>{u.value=e.target.value},te=()=>{_.create(u.value).then(e=>{e.error?(console.log("PieceCreateError",e.error),m.value=e.error,document.getElementById("NewForm").reset(),u.value="",setTimeout(()=>{m.value=null},500)):e.success&&(u.value="",v.value=e.message,document.getElementById("NewForm").reset(),setTimeout(()=>{v.value=null,f.value=!1},500))}).catch(e=>{console.log(e)}).finally(()=>{u.value=""})},le=()=>{console.log($.value),_.edit($.value.id,u.value).then(e=>{e.error?(console.log("errorExcution",e.error,e),m.value=e.error,document.getElementById("EditForm").reset(),setTimeout(()=>{m.value=null,u.value=""},3e3)):e.success&&(u.value="",v.value=e.message,P.value=!1,document.getElementById("EditForm").reset(),setTimeout(()=>{v.value=null},3e3))}).catch(e=>{console.log(e)}).finally(()=>{u.value=""})},ae=()=>{_.delete($.value.id).then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{})};return(e,l)=>(r(),i(B,null,[n(M,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value=t),title:a(c)("pieces.modal.create.title"),"button-label":a(c)("common.save"),button:"bg-main","has-cancel":"",onConfirm:te,showModal:!0},{default:p(()=>[n(a(R),{"validation-schema":a(U),id:"NewForm"},{default:p(()=>[n(fe,{"input-type":"text",name:"piece",onInput:z,value:u.value,placeholder:a(c)("pieces.modal.create.placeholder"),class:"w-full mb-6 font-readex text-base font-light focus:outline-none"},null,8,["value","placeholder"]),m.value?(r(),i("div",Ee,[o("p",Pe,d(m.value),1)])):h("",!0),v.value?(r(),i("div",$e,[o("p",Be,d(v.value),1)])):h("",!0)]),_:1},8,["validation-schema"])]),_:1},8,["modelValue","title","button-label"]),n(M,{modelValue:P.value,"onUpdate:modelValue":l[1]||(l[1]=t=>P.value=t),title:a(c)("pieces.modal.edit.title"),button:"bg-main","has-cancel":"",onConfirm:le},{default:p(()=>[n(a(R),{"validation-schema":a(U),id:"EditForm"},{default:p(()=>{var t;return[o("div",Ve,[o("input",{type:"text",placeholder:"",class:"w-full px-1 py-1 rounded-lg text-right focus:outline-none h-9",value:(t=a($))==null?void 0:t.title,onInput:z},null,40,Ae)]),m.value?(r(),i("div",Me,[o("p",Te,d(m.value),1)])):h("",!0),v.value?(r(),i("div",De,[o("p",Fe,d(v.value),1)])):h("",!0)]}),_:1},8,["validation-schema"])]),_:1},8,["modelValue","title"]),n(M,{modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=t=>V.value=t),title:a(c)("pieces.modal.delete.title"),button:"bg-main","has-cancel":"",onConfirm:ae},{default:p(()=>[Ie]),_:1},8,["modelValue","title"]),x.value.length?(r(),i("div",Se,[(r(!0),i(B,null,D(x.value,t=>(r(),i("span",{key:t.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-slate-700"},d(t.name),1))),128))])):h("",!0),o("table",null,[o("thead",null,[o("tr",null,[(r(!0),i(B,null,D(S.value,t=>(r(),i("th",{key:t.id,onClick:w=>X(t.id),class:"cursor-pointer"},[j(n(Ne,{path:g.value?a(we):a(ke),class:"text-gray-600"},null,8,["path"]),[[L,t.id===b.value]]),_e(" "+d(t.label),1)],8,Ue))),128)),N.checkable?(r(),i("th",qe)):h("",!0)])]),o("tbody",null,[o("tr",null,[j(o("td",ze,[o("div",He,[n(a(ne),{"animation-duration":1e3,size:60,color:"#4BC49A"})])],512),[[L,a(O)]])]),(r(!0),i(B,null,D(K.value,t=>(r(),i("tr",{key:t.id},[o("td",Re,[n(oe,{type:"justify-start lg:justify-end","no-wrap":""},{default:p(()=>[n(F,{color:"brandGreen",icon:a(ye),small:"",border:"border",borderColor:"brandBorder",onClick:w=>ee(t)},null,8,["icon","onClick"]),n(F,{color:"white",icon:a(Ce),small:"",border:"border",borderColor:"brandBorder",onClick:()=>Z(t)},null,8,["icon","onClick"])]),_:2},1024)]),o("td",je,[o("small",Le,d(a(be)(new Date(t.createdAt),"dd-MM-yyyy HH:mm")),1)]),o("td",Ge,d(t.title),1),o("td",Je,d(t.id),1),N.checkable?(r(),he(re,{key:0,onChecked:l[3]||(l[3]=w=>W(w,e.client))})):h("",!0)]))),128))])]),n(a(ge),{modelValue:C.value,"onUpdate:modelValue":l[4]||(l[4]=t=>C.value=t),"total-row":q.value.length,language:"en","page-size-menu":[5,10,20],onChange:Y,class:"my-8"},null,8,["modelValue","total-row"])],64))}},Ke={__name:"Header",props:{},emits:["handleClickNewPiece"],setup(N,{emit:k}){const{t:y}=J();return s(!1),(f,E)=>(r(),i("div",null,[n(F,{label:a(y)("pieces.create"),labelColor:"text-white",icon:a(xe),color:"text-white",bgColor:"!bg-main",border:"border",outline:"",borderColor:"brandBorder",onClick:E[0]||(E[0]=c=>k("handleClickNewPiece"))},null,8,["label","icon"])]))}},tt={__name:"List",setup(N){const k=s(!1),y=s(null),f=()=>{console.log("new piece"),k.value=!0,y.value.showNewModal()};return(E,c)=>(r(),i("div",null,[n(ce,null,{default:p(()=>[n(Ke,{onHandleClickNewPiece:f}),n(se,{class:"mb-6 mt-6","has-table":""},{default:p(()=>[n(Oe,{ref_key:"tableCompRef",ref:y},null,512)]),_:1})]),_:1})]))}};export{tt as default};
