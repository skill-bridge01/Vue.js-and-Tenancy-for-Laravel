var n=Object.defineProperty;var h=(t,e,i)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var r=(t,e,i)=>(h(t,typeof e!="symbol"?e+"":e,i),i);import{a2 as s,a3 as o,a4 as d}from"./app-c03dcb6d.js";class p{constructor(){r(this,"apiUrl","/pieces")}create(e){return s.post(this.apiUrl,{title:e})}getList(){return s.get(this.apiUrl+"/")}edit(e,i){return s.put(this.apiUrl+"/"+e,{title:i})}delete(e){return s.delete(this.apiUrl+"/"+e)}}const c=new p,g=o("piece",{state:()=>({selectedPiece:null,pieceSelected:!1,pieces:[],pieceFetchError:null,loading:!1}),actions:{clear(){this.selectedPiece=null,this.pieceSelected=!1,this.loading=!1},setSelectedPiece(t){console.log(t.id),this.selectedPiece=t,t?this.pieceSelected=!0:this.pieceSelected=!1},fetch(){this.loading=!0,c.getList().then(t=>{this.pieces=t.data}).catch(t=>{this.pieceFetchError=t}).finally(()=>{this.loading=!1})},fetchLocalData(){d.get("data-sources/pieces.json",{baseURL:window.location.origin}).then(t=>{console.log(t.data),this.pieces=t.data})},async create(t){this.loading=!0;try{const e=await c.create(t);return e.data.piece&&this.pieces.push(e.data.piece),e.data}catch(e){return this.pieceFetchError=e,e}finally{this.loading=!1}},async edit(t,e){this.loading=!0;try{const i=await c.edit(t,e),a=this.pieces.findIndex(l=>l.id===t);return this.pieces[a]=i.data,!0}catch(i){return this.pieceFetchError=i,i}finally{this.loading=!1}},async delete(t){this.loading=!0;try{return await c.delete(t),console.log("pieces::",this.pieces,t),this.pieces=this.pieces.filter(e=>e.id!==t),!0}catch(e){return this.pieceFetchError=e,e}finally{this.loading=!1}}}});export{g as u};
