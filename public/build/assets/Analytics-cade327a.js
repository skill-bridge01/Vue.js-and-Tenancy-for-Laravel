import{a2 as S,a3 as P,u as f,x,r as p,w as D,Q as b,D as B,o as u,c as d,E as m,a as h,t as g,b as w,q as V,n as L,F as C,d as N,l as M,m as O,k as E}from"./app-c03dcb6d.js";class W{getStatistics(e){return S.post("/get-statstices/",{query:e})}getYear(){return S.post("/get-statstices/",{query:"year"})}getMonth(){return S.post("/get-statstices/",{query:"month"})}getToday(){return S.post("/get-statstices/",{query:"today"})}getLaundryInfo(){return S.post("/get-laundry-info")}}const q=new W,y=P("statistics",{state:()=>({yearData:null,monthData:null,dayData:null,error:null,loading:!1,currentTabIndex:0,totalSales:[],mostPurchasedCustomerArr:[],mostServicedItems:[],mostServices:[]}),actions:{clear(){this.yearData=null,this.monthData=null,this.dayData=null},setLoading(t){this.loading=t},setYearData(t){this.yearData=t},setMonthData(t){this.monthData=t},setDayData(t){this.dayData=t},setCurrentTabIndex(t){this.currentTabIndex=t},setData(t){this.totalSales=t.total_sales,this.mostPurchasedCustomerArr=t.most_purchased_customers,this.mostServicedItems=t.most_serviced_items,this.mostServices=t.most_services},fetch(t="day"){this.setLoading(!0),q.getStatistics(t).then(e=>{const{status:o,cards:s}=e.data;if(o)switch(this.setData(s),t){case"day":this.setDayData(s);break;case"month":this.setMonthData(s);break;case"year":this.setYearData(s);break}}).catch(e=>{console.log(e)})}}}),k=t=>{switch(t){case 2:return[2,4,8,10,12,14,16,18,20,22,24];case 1:return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];case 0:return[1,2,3,4,5,6,7,8,9,10,11,12]}},$=t=>{switch(t){case 0:return"year";case 1:return"month";case 2:return"day"}},v=(t=[],e)=>(console.log(`tab index : ${e}`),t.map((s,r)=>{let a="",l="",n="";return e===0?(a=s.year_service_data?s.year_service_data.services_title:null,l=s.year_piece_data?s.year_piece_data.piece_title:null,n=s.number_of_piece?parseInt(s.number_of_piece):0):e===1?(a=s.month_service_data?s.month_service_data.services_title:null,l=s.month_piece_data?s.month_piece_data.piece_title:null,n=s.number_of_piece?parseInt(s.number_of_piece):0):(a=s.day_service_data?s.day_service_data.services_title:null,l=s.day_piece_data?s.day_piece_data.piece_title:null,n=s.number_of_piece?parseInt(s.number_of_piece):0),{serviceName:a,pieceName:l,count:n}})),F=(t=[])=>{console.log(t);const e=t.map((o,s)=>({amount:parseInt(o.total),...o.customer_data}));return console.log("newdata"),console.log(e),e},j={__name:"SaleChart",setup(t){const{t:e}=f(),{yearData:o,monthData:s,dayData:r,totalSales:a,loading:l,currentTabIndex:n}=x(y()),c=p({colors:["#4BC49A"],chart:{type:"area",height:"auto",width:"100%",zoom:{enabled:!1},toolbar:{show:!1},foreColor:"#373d3f"},dataLabels:{enabled:!1},stroke:{curve:"straight"},fill:{colors:["#4BC49A"],type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,90,100]}},title:{text:e("analytics.chart.sales"),align:"right",style:{fontSize:"16px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#0D0D0D"}},subtitle:{text:"0",align:"right",style:{fontSize:"36px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#484860"}},xaxis:{categories:k(n.value)},yaxis:{opposite:!0},legend:{horizontalAlign:"left"}}),i=p([{name:"Vue Chart",data:[30,40,45,50,49,60,70,81,98,78,96]}]);return D(()=>{c.value={...c.value,title:{...c.value.title,text:e("analytics.chart.sales")}}}),b(n,async(_,I)=>{c.value={...c.value,xaxis:{categories:k(_)}}}),b(a,async(_,I)=>{i.value=[{name:"Total Sales",data:_}];const T=_.reduce((A,z)=>A+z,0);c.value={...c.value,subtitle:{text:`${T}`,align:"right",style:{fontSize:"36px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#484860"}}}}),(_,I)=>{const T=B("apexchart");return u(),d("div",null,[m(T,{type:"area",options:c.value,series:i.value,class:"mx-auto"},null,8,["options","series"])])}}},Y={__name:"SellingServiceChart",setup(t){const{mostServices:e,loading:o,currentTabIndex:s}=x(y()),{t:r}=f(),a=p([]),l=p({colors:["#4BC49A","#3699FF","#F53488"],chart:{type:"line",height:"auto",width:"100%",zoom:{enabled:!1},toolbar:{show:!1},foreColor:"#373d3f"},dataLabels:{enabled:!1},stroke:{curve:"straight"},title:{text:r("analytics.chart.bestSellingServices"),align:"right",style:{fontSize:"16px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#0D0D0D"}},subtitle:{text:"",align:"right",style:{fontSize:"36px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#484860"}},xaxis:{categories:k(s.value)},yaxis:{opposite:!0},legend:{horizontalAlign:"left"}});return D(()=>{l.value={...l.value,title:{...l.value.title,text:r("analytics.chart.bestSellingServices")}}}),b(s,async(n,c)=>{l.value={...l.value,xaxis:{categories:k(n)}}}),b(e,async(n,c)=>{let i=n.map((_,I)=>({name:`${_.service_name}`,data:_.sub_total}));a.value=[...i]}),(n,c)=>{const i=B("apexchart");return u(),d("div",null,[m(i,{type:"line",options:l.value,series:a.value,class:"mx-auto"},null,8,["options","series"])])}}},Q={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},G={__name:"SalesSection",setup(t){return(e,o)=>(u(),d("div",Q,[m(Y,{class:"p-4 rounded-md shadow-md bg-white"}),m(j,{class:"p-4 rounded-md shadow-md bg-white"})]))}},H={__name:"DemandService",setup(t){const{t:e}=f(),{mostServicedItems:o,loading:s,currentTabIndex:r}=x(y()),a=p({chart:{width:380,type:"donut"},dataLabels:{enabled:!1},labels:v(o.value,r.value).length?v(o.value,r.value).map(n=>n.serviceName):[],responsive:[{breakpoint:480,options:{chart:{width:200},legend:{show:!1}}}],legend:{position:"bottom",offsetY:0,height:30},title:{text:e("analytics.chart.mostRequestedServices"),align:"right",style:{fontSize:"16px",fontWeight:"normal",fontFamily:"Readex Pro",color:"#0D0D0D"}}});D(()=>{a.value={...a.value,title:{...a.value.title,text:e("analytics.chart.mostRequestedServices")}}});const l=p(v(o.value,r.value).length?v(o.value,r.value).map(n=>n.count):[]);return b(o,async(n,c)=>{console.log(n),a.value={...a.value,labels:v(n,r.value).length?v(n,r.value).map(i=>i.serviceName):[]},console.log(v(n,r.value).map(i=>i.serviceName)),l.value=v(n,r.value).map(i=>i.count)}),(n,c)=>{const i=B("apexchart");return u(),d("div",null,[m(i,{type:"donut",options:a.value,series:l.value,class:"mx-auto"},null,8,["options","series"])])}}},J={class:"p-4 rounded-md shadow-md bg-white"},K={key:0,type:"button",class:"underline text-main"},U={class:"font-readex text-base text-[#0D0D0D]"},X={class:"rounded-2xl border border-solid border-[#E2E8F0]"},Z={"data-label":"amount"},ee={"data-label":"invoice"},R={__name:"StatisticTable",props:{title:String,tableOptions:{type:Object,default:{headerLabels:[],data:[]}},dataType:{type:String,default:"invoices"}},setup(t){const e=t,{t:o}=f();return x(y()),(s,r)=>(u(),d("div",J,[h("div",{class:L(["flex items-center mb-4",t.dataType==="invoices"?"justify-between":"justify-end"])},[t.dataType==="invoices"?(u(),d("button",K,g(w(o)("analytics.chart.viewAll")),1)):V("",!0),h("p",U,g(t.title),1)],2),h("div",X,[h("table",null,[h("thead",null,[h("tr",null,[(u(!0),d(C,null,N(e.tableOptions.headerLabels,a=>(u(),d("th",{key:a},g(a),1))),128))])]),h("tbody",null,[(u(!0),d(C,null,N(e.tableOptions.data,(a,l)=>(u(),d("tr",{key:l},[h("td",Z,g((e.dataType==="invoices",a.amount+" ر.س")),1),h("td",ee,g(e.dataType==="invoices"?a.invoiceNumber:a.name),1)]))),128))])])])]))}},te={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ae={__name:"StatisticsSection",setup(t){const{t:e}=f(),{mostPurchasedCustomerArr:o,loading:s,currentTabIndex:r}=x(y()),a=p({headerLabels:[e("analytics.chart.totalBills"),e("analytics.chart.customer")],data:F(o.value)}),l={headerLabels:[e("analytics.chart.value"),e("analytics.chart.bill")],data:[{amount:123,invoiceNumber:"INV-23-16574"},{amount:85,invoiceNumber:"INV-23-16574"},{amount:5,invoiceNumber:"INV-23-16574"},{amount:1,invoiceNumber:"INV-23-16574"},{amount:5,invoiceNumber:"INV-23-16574"}]};return D(()=>{l.headerLabels=[e("analytics.chart.value"),e("analytics.chart.bill")],a.value.headerLabels=[e("analytics.chart.totalBills"),e("analytics.chart.customer")]}),b(o,async(n,c)=>{console.log(n),a.value={...a.value,data:F(n)}}),(n,c)=>(u(),d("div",te,[m(R,{"data-type":"customers",title:w(e)("analytics.chart.mostPurchasedCustomers"),"table-options":a.value},null,8,["title","table-options"]),m(H,{class:"p-4 rounded-md shadow-md bg-white"}),m(R,{"data-type":"invoices",title:w(e)("analytics.chart.mostPurchasedCustomers"),"table-options":l},null,8,["title"])]))}},se={class:"w-40"},ne={__name:"BaseTab",props:{active:Boolean,title:String,first:Boolean,last:Boolean,index:Number},emits:["onClick"],setup(t,{emit:e}){const o=t,s=()=>{e("onClick",o.index)},r=M(()=>{const a=["inline-block","w-full","p-4","focus:outline-none"," font-readex font-medium text-base"];return o.active?a.push(["text-white","bg-main","active","dark:bg-gray-700","dark:text-white",""]):a.push(["bg-white","hover:text-gray-700","hover:bg-gray-50","dark:hover:text-white","dark:bg-gray-800","dark:hover:bg-gray-700"]),o.first&&a.push(["rounded-l-lg"]),o.last&&a.push(["rounded-r-lg"]),a});return(a,l)=>(u(),d("li",se,[h("a",{href:"#",class:L(r.value),onClick:s},g(o.title),3)]))}},oe={class:"flex text-sm font-medium text-center text-gray-500 divide-x divide-gray-200 rounded-lg shadow dark:divide-gray-700 dark:text-gray-400 max-w-min"},le={__name:"BaseTabs",props:{tabs:Array,currentIndex:{type:Number,default:0}},emits:["changeCurrentIndex"],setup(t,{emit:e}){const o=t,s=r=>{e("changeCurrentIndex",r)};return(r,a)=>(u(),d("ul",oe,[(u(!0),d(C,null,N(t.tabs,(l,n)=>(u(),O(ne,{active:o.currentIndex===n,first:n===0,last:n===t.tabs.length-1,title:l.title,index:n,onOnClick:s},null,8,["active","first","last","title","index"]))),256))]))}},ie={class:"flex justify-end"},ce={__name:"Analytics",setup(t){const{t:e,locale:o}=f(),{loading:s,currentTabIndex:r}=x(y()),a=p([{active:!1,title:e("analytics.tabs.allTime"),type:"allTime"},{active:!1,title:e("analytics.tabs.thisMonth"),type:"thisMonth"},{active:!0,title:e("analytics.tabs.today"),type:"today"}]);D(()=>{a.value.forEach(i=>{switch(i.type){case"allTime":i.title=e("analytics.tabs.allTime");break;case"thisMonth":i.title=e("analytics.tabs.thisMonth");break;case"today":i.title=e("analytics.tabs.today");break}})}),p([]);const l=p(0),n=y();E(()=>{n.fetch($(r.value))});const c=i=>{l.value=i,n.setCurrentTabIndex(i),n.fetch($(i))};return(i,_)=>(u(),d(C,null,[h("div",null,[h("div",ie,[m(le,{tabs:a.value,"current-index":l.value,onChangeCurrentIndex:c},null,8,["tabs","current-index"])])]),m(G,{class:"my-6"}),m(ae)],64))}};export{ce as default};
